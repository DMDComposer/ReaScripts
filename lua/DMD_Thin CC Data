-- robgb
reaper.Main_OnCommand(41866, 0) -- selects volume envelope for current track

OpenEditorCommand_id = reaper.NamedCommandLookup(
                           "_RS0ff4cded2383187077d9eeca4e95032cd553d57c", 0) -- opens midi editor and zooms to content
reaper.Main_OnCommand(OpenEditorCommand_id, 0)

HWND = reaper.MIDIEditor_GetActive() -- get MIDIEditor Number

SetToCC1 = reaper.NamedCommandLookup("_S&M_SETCCLANES_ME2", 0) -- restore to CC 1
reaper.MIDIEditor_OnCommand(HWND, SetToCC1)

command_id = reaper.NamedCommandLookup(
                 "_RS7d3c_ad8d4cee9621c4cc81e08dfbf1ef658f6d9a539a", 0) -- selects cc1 lane
reaper.MIDIEditor_OnCommand(HWND, command_id)

copycc_id = reaper.NamedCommandLookup("_BR_ME_CC_TO_ENV_LINEAR_CLEAR", 0) -- copies cc1 lane event to envelope
reaper.MIDIEditor_OnCommand(HWND, copycc_id)

closeeditor = reaper.NamedCommandLookup(
                  "_RS7d3c_e0cd2a44410da646d94b2a5f7689da62970fc08a", 0) -- close midi editors
reaper.MIDIEditor_OnCommand(HWND, closeeditor)

reaper.Main_OnCommand(40332, 0) -- selects all envelope points

reaper.Main_OnCommand(40683, 0) -- changes points to bezier

reaper.Main_OnCommand(41622, 0) -- toggle zoom selected item

reaper.Main_OnCommand(40887, 0) -- calls up reduce number of points script

OpenEditorCommand_id = reaper.NamedCommandLookup(
                           "_RS0ff4cded2383187077d9eeca4e95032cd553d57c", 0) -- opens midi editor and zooms to content
reaper.Main_OnCommand(OpenEditorCommand_id, 0)

HWND2 = reaper.MIDIEditor_GetActive() -- get MIDIEditor Number

ConvertEnv = reaper.NamedCommandLookup("_BR_ME_ENV_TO_CC_CLEAR", 0) -- converts envelope to cc lane
reaper.MIDIEditor_OnCommand(HWND2, ConvertEnv)

SetToCC1 = reaper.NamedCommandLookup("_S&M_SETCCLANES_ME2", 0) -- restore to CC 1
reaper.MIDIEditor_OnCommand(HWND, SetToCC1)

reaper.MIDIEditor_OnCommand(HWND2, command_id) -- selects cc1 lane

reaper.MIDIEditor_OnCommand(HWND2, 42085) -- turns cc1 lane shape to bezier

reaper.MIDIEditor_OnCommand(HWND2, 40671) -- unselects all CC events

reaper.Main_OnCommand(40333, 0) -- delete all selected points

reaper.Main_OnCommand(41150, 0) -- hide envelopes

closeeditor = reaper.NamedCommandLookup(
                  "_RS7d3c_e0cd2a44410da646d94b2a5f7689da62970fc08a", 0) -- close midi editors
reaper.MIDIEditor_OnCommand(HWND2, closeeditor)

reaper.Main_OnCommand(41622, 0) -- toggle zoom selected item
